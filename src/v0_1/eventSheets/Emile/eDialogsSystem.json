{
	"name": "eDialogsSystem",
	"events": [
		{
			"eventType": "variable",
			"name": "bIsDialogMode",
			"type": "boolean",
			"initialValue": "false",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 318069421722408
		},
		{
			"eventType": "variable",
			"name": "CHOICE_BUTTON_INITIAL_SPAWN_Y",
			"type": "number",
			"initialValue": "480",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 567994772483965
		},
		{
			"eventType": "variable",
			"name": "CHOICE_BUTTON_MARGIN",
			"type": "number",
			"initialValue": "32",
			"comment": "",
			"isStatic": false,
			"isConstant": true,
			"sid": 278107052179653
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-created",
					"objectClass": "npDialogChoice",
					"sid": 638666006900014
				}
			],
			"actions": [
				{
					"id": "tween-one-property",
					"objectClass": "npDialogChoice",
					"sid": 733712293001241,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "\"\"",
						"property": "offsetY",
						"end-value": "400",
						"time": "0.5",
						"ease": "easeinback",
						"destroy-on-complete": "no",
						"loop": "no",
						"ping-pong": "no",
						"repeat-count": "1"
					}
				}
			],
			"sid": 183386577170012
		},
		{
			"eventType": "comment",
			"text": "A function which needs to run at the start of whichever layout the DialogSystem will be used on."
		},
		{
			"functionName": "InitDialogSystem",
			"functionDescription": "A function which needs to run at the start of whichever layout the DialogSystem will be used on.",
			"functionCategory": "DialogSystem",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [
				{
					"id": "request-project-file",
					"objectClass": "AJAX",
					"sid": 406550579607162,
					"parameters": {
						"tag": "\"dialog_load\"",
						"file": "RefDialogsData.json"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 107310539993226
				},
				{
					"id": "parse",
					"objectClass": "jsonDialogsData",
					"sid": 927577116820543,
					"parameters": {
						"data": "AJAX.LastData"
					}
				},
				{
					"type": "comment",
					"text": "Replaced by spritefont"
				},
				{
					"id": "set-text",
					"objectClass": "Text",
					"sid": 675600821780315,
					"disabled": true,
					"parameters": {
						"text": "jsonDialogsData.Get(\"lines.0\")"
					}
				}
			],
			"sid": 167503349842810
		},
		{
			"eventType": "comment",
			"text": "A function which acts as a convenience toggle for the E key."
		},
		{
			"functionName": "ToggleDialogBox",
			"functionDescription": "A function which acts as a convenience toggle for the E key.",
			"functionCategory": "DialogSystem",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 191961447393540,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-boolean-eventvar",
							"objectClass": "System",
							"sid": 490670523330309,
							"parameters": {
								"variable": "bIsDialogMode"
							},
							"isInverted": true
						}
					],
					"actions": [
						{
							"callFunction": "DisplayDialogBox",
							"sid": 678822240702248
						}
					],
					"sid": 306627193667045
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 392564339662029
						},
						{
							"id": "compare-boolean-eventvar",
							"objectClass": "System",
							"sid": 699236923755922,
							"parameters": {
								"variable": "bIsDialogMode"
							}
						}
					],
					"actions": [
						{
							"callFunction": "HideDialogBox",
							"sid": 426502635514706
						}
					],
					"sid": 316274087197150
				}
			]
		},
		{
			"eventType": "comment",
			"text": "A function to put the dialog box UI on-screen."
		},
		{
			"functionName": "DisplayDialogBox",
			"functionDescription": "A function to put the dialog box UI on-screen.",
			"functionCategory": "DialogSystem",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 902452349570772,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "layer-is-visible",
							"objectClass": "System",
							"sid": 540594100333995,
							"parameters": {
								"layer": "\"HUD_Dialogs\""
							},
							"isInverted": true
						}
					],
					"actions": [
						{
							"id": "set-layer-visible",
							"objectClass": "System",
							"sid": 179371659659581,
							"parameters": {
								"layer": "\"HUD_Dialogs\"",
								"visibility": "visible"
							}
						},
						{
							"callFunction": "PullDialogText",
							"sid": 968815845988150,
							"parameters": [
								"0",
								"1"
							]
						},
						{
							"id": "set-boolean-eventvar",
							"objectClass": "System",
							"sid": 468039618896043,
							"parameters": {
								"variable": "bIsDialogMode",
								"value": "true"
							}
						}
					],
					"sid": 927410290555342
				}
			]
		},
		{
			"eventType": "comment",
			"text": "A function to remove the dialog box UI from the screen."
		},
		{
			"functionName": "HideDialogBox",
			"functionDescription": "A function to remove the dialog box UI from the screen.",
			"functionCategory": "DialogSystem",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 551054835002174,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "layer-is-visible",
							"objectClass": "System",
							"sid": 667081352782748,
							"parameters": {
								"layer": "\"HUD_Dialogs\""
							}
						}
					],
					"actions": [
						{
							"id": "set-layer-visible",
							"objectClass": "System",
							"sid": 370133092381016,
							"parameters": {
								"layer": "\"HUD_Dialogs\"",
								"visibility": "invisible"
							}
						},
						{
							"id": "set-boolean-eventvar",
							"objectClass": "System",
							"sid": 695176584611208,
							"parameters": {
								"variable": "bIsDialogMode",
								"value": "false"
							}
						}
					],
					"sid": 515930515304326
				}
			]
		},
		{
			"functionName": "PullDialogText",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "pDialogStory",
					"type": "number",
					"initialValue": "-1",
					"comment": "",
					"sid": 674323268591386
				},
				{
					"name": "pDialogLine",
					"type": "number",
					"initialValue": "-1",
					"comment": "",
					"sid": 475138684193896
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 303761251514374,
			"children": [
				{
					"eventType": "variable",
					"name": "last_story_access_str",
					"type": "string",
					"initialValue": "NULL",
					"comment": "",
					"isStatic": true,
					"isConstant": false,
					"sid": 741422477146826
				},
				{
					"eventType": "variable",
					"name": "last_line_access_str",
					"type": "string",
					"initialValue": "NULL",
					"comment": "",
					"isStatic": true,
					"isConstant": false,
					"sid": 593760548509691
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 959000216303964,
							"parameters": {
								"variable": "last_story_access_str",
								"value": "\"stories.\"&str(pDialogStory)"
							}
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 216182480493705,
							"parameters": {
								"variable": "last_line_access_str",
								"value": "last_story_access_str&\".lines.\"&str(pDialogLine)"
							}
						}
					],
					"sid": 617746150289565,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-by-comparison",
									"objectClass": "System",
									"sid": 313858749431274,
									"parameters": {
										"object": "sfTimesNewYorker",
										"expression": "sfTimesNewYorker.TemplateName",
										"comparison": 0,
										"value": "\"Spritefont1_Text\""
									}
								}
							],
							"actions": [
								{
									"id": "typewriter-text",
									"objectClass": "sfTimesNewYorker",
									"sid": 812778449808445,
									"parameters": {
										"text": "jsonDialogsData.Get(last_line_access_str&\".text\")",
										"duration": "0.04 * len(jsonDialogsData.Get(last_line_access_str&\".text\"))"
									}
								}
							],
							"sid": 399422387252886
						}
					]
				},
				{
					"eventType": "variable",
					"name": "last_choices_access_str",
					"type": "string",
					"initialValue": "NULL",
					"comment": "",
					"isStatic": true,
					"isConstant": false,
					"sid": 895134144195585
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 181836445780088,
							"parameters": {
								"variable": "last_choices_access_str",
								"value": "last_story_access_str&\".lines.\"&str(pDialogLine)&\".choices\""
							}
						},
						{
							"callFunction": "CreateDialogChoice",
							"sid": 392955131498338,
							"parameters": [
								"last_choices_access_str"
							]
						}
					],
					"sid": 901189748429778
				}
			]
		},
		{
			"functionName": "CreateDialogChoice",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "pChoicesAccessStr",
					"type": "string",
					"initialValue": "NULL",
					"comment": "",
					"sid": 991836306258598
				}
			],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 260034986543526,
			"children": [
				{
					"eventType": "variable",
					"name": "last_choice_cnt",
					"type": "number",
					"initialValue": "-1",
					"comment": "",
					"isStatic": true,
					"isConstant": false,
					"sid": 830222404377305
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 394063877811817,
							"parameters": {
								"variable": "last_choice_cnt",
								"value": "jsonDialogsData.ArraySize(pChoicesAccessStr)"
							}
						}
					],
					"sid": 376156920759018
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 208524180836026,
							"parameters": {
								"first-value": "last_choice_cnt",
								"comparison": 4,
								"second-value": "0"
							}
						}
					],
					"actions": [],
					"sid": 891832943527090,
					"children": [
						{
							"eventType": "variable",
							"name": "last_choice_text",
							"type": "string",
							"initialValue": "NULL",
							"comment": "",
							"isStatic": false,
							"isConstant": false,
							"sid": 579836780354039
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 229885269329610,
									"parameters": {
										"name": "\"i\"",
										"start-index": "1",
										"end-index": "last_choice_cnt"
									}
								}
							],
							"actions": [
								{
									"id": "create-object",
									"objectClass": "System",
									"sid": 348733326617821,
									"parameters": {
										"object-to-create": "npDialogChoice",
										"layer": "\"HUD_Dialogs\"",
										"x": "(ViewportWidth(\"HUD_Dialogs\")/2) - (((128*last_choice_cnt)+(32*(last_choice_cnt-1)))/2) + ((loopindex(\"i\")-1) * 160)",
										"y": "CHOICE_BUTTON_INITIAL_SPAWN_Y",
										"create-hierarchy": true,
										"template-name": "\"\""
									}
								}
							],
							"sid": 722468349013364,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-children",
											"objectClass": "npDialogChoice",
											"sid": 482040441768460,
											"parameters": {
												"child": "sfTimesNewYorker",
												"which": "own"
											}
										}
									],
									"actions": [
										{
											"id": "set-text",
											"objectClass": "sfTimesNewYorker",
											"sid": 466395651112063,
											"parameters": {
												"text": "jsonDialogsData.Get(pChoicesAccessStr&\".\"&str(loopindex(\"i\")-1))"
											}
										}
									],
									"sid": 977176197590058
								}
							]
						}
					]
				}
			]
		}
	],
	"sid": 812242941960170
}